2025-12-14 00:14:38 [INFO] [__main__] Environment summary: PG=host.docker.internal:5432 DB=ultimate_advisor OLLAMA_HOST=http://ollama:11434 EMB_MODEL=qwen3-embedding:latest GEMINI_MODEL=gemini-2.5-flash-lite RELOAD=False
2025-12-14 00:14:39 [INFO] [app.table_selector_llm] Using 2 default table schemas
2025-12-14 00:14:39 [INFO] [__main__] Router mounted successfully.
2025-12-14 00:14:39 [INFO] [app.main] Environment summary: PG=host.docker.internal:5432 DB=ultimate_advisor OLLAMA_HOST=http://ollama:11434 EMB_MODEL=qwen3-embedding:latest GEMINI_MODEL=gemini-2.5-flash-lite RELOAD=False
2025-12-14 00:14:39 [INFO] [app.main] Router mounted successfully.
2025-12-13 17:14:39,346 INFO uvicorn.error: Started server process [1]
2025-12-13 17:14:39,347 INFO uvicorn.error: Waiting for application startup.
2025-12-13 17:14:39,348 INFO uvicorn.error: Application startup complete.
2025-12-13 17:14:39,349 INFO uvicorn.error: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-12-13 17:20:14,756 INFO uvicorn.access: 172.18.0.1:38274 - "GET /docs HTTP/1.1" 200
2025-12-13 17:20:15,140 INFO uvicorn.access: 172.18.0.1:38274 - "GET /openapi.json HTTP/1.1" 200
2025-12-14 00:23:42 [INFO] [app.table_selector_llm] LLM response: ```json
{
    "selected_tables": [
        {
            "schema": "public",
            "table": "bompk_data",
            "confidence": 0.9,
            "reason": "Câu hỏi đề cập đến 'vật liệu ĐINH ...
2025-12-14 00:23:42 [INFO] [app.table_selector_llm] LLM selected 1 tables: [('bompk_data', 0.9)]
2025-12-14 00:23:42 [INFO] [app.routers.rag] Selected table: public.bompk_data (score=0.900)
2025-12-14 00:23:48 [INFO] [app.routers.rag] Generated embedding vector of dim=4096 for query
2025-12-14 00:23:48 [INFO] [app.db] f_get_embedding_dimension
2025-12-14 00:23:48 [INFO] [app.routers.rag] Query vec dim=4096, DB vec dim for public.bompk_data=768
2025-12-14 00:23:48 [INFO] [app.routers.rag] Aligned query vec dim=768
2025-12-14 00:23:48 [INFO] [app.db] Performing similarity search on public.bompk_data with top_k=7 and min_score=0.300
2025-12-14 00:23:48 [INFO] [app.db] f_get_embedding_dimension
2025-12-14 00:23:48 [INFO] [app.db] f__table_topk
2025-12-14 00:23:48 [INFO] [app.db] f__table_topk SQL query on 
                SELECT 
                    id, original_data, content_text, 
                    (1 - (embedding <=> %s::vector))::double precision AS score
                FROM "public"."bompk_data"
                WHERE embedding IS NOT NULL
                ORDER BY embedding <=> %s::vector
                LIMIT %s;
            
2025-12-14 00:23:49 [INFO] [app.db] Results - END
2025-12-13 17:23:51,324 INFO uvicorn.access: 172.18.0.1:56162 - "POST /query HTTP/1.1" 200
2025-12-13 17:27:48,604 INFO uvicorn.error: Shutting down
2025-12-13 17:27:48,706 INFO uvicorn.error: Waiting for application shutdown.
2025-12-13 17:27:48,708 INFO uvicorn.error: Application shutdown complete.
2025-12-13 17:27:48,708 INFO uvicorn.error: Finished server process [1]
2025-12-13 17:27:59,766 INFO uvicorn.error: Started server process [1]
2025-12-13 17:27:59,767 INFO uvicorn.error: Waiting for application startup.
2025-12-13 17:27:59,768 INFO uvicorn.error: Application startup complete.
2025-12-13 17:27:59,769 INFO uvicorn.error: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-12-13 17:29:00,069 INFO uvicorn.error: Shutting down
2025-12-13 17:29:00,170 INFO uvicorn.error: Waiting for application shutdown.
2025-12-13 17:29:00,172 INFO uvicorn.error: Application shutdown complete.
2025-12-13 17:29:00,173 INFO uvicorn.error: Finished server process [1]
2025-12-13 17:29:12,002 INFO uvicorn.error: Started server process [1]
2025-12-13 17:29:12,003 INFO uvicorn.error: Waiting for application startup.
2025-12-13 17:29:12,004 INFO uvicorn.error: Application startup complete.
2025-12-13 17:29:12,011 INFO uvicorn.error: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-12-13 17:32:07,874 INFO uvicorn.error: Shutting down
2025-12-13 17:32:07,975 INFO uvicorn.error: Waiting for application shutdown.
2025-12-13 17:32:07,977 INFO uvicorn.error: Application shutdown complete.
2025-12-13 17:32:07,978 INFO uvicorn.error: Finished server process [1]
2025-12-13 17:32:21,421 INFO uvicorn.error: Started server process [1]
2025-12-13 17:32:21,422 INFO uvicorn.error: Waiting for application startup.
2025-12-13 17:32:21,427 INFO uvicorn.error: Application startup complete.
2025-12-13 17:32:21,432 INFO uvicorn.error: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-12-13 17:33:43,536 INFO uvicorn.error: Shutting down
2025-12-13 17:33:43,638 INFO uvicorn.error: Waiting for application shutdown.
2025-12-13 17:33:56,147 INFO uvicorn.error: Started server process [1]
2025-12-13 17:33:56,147 INFO uvicorn.error: Waiting for application startup.
2025-12-13 17:33:56,148 INFO uvicorn.error: Application startup complete.
2025-12-13 17:33:56,149 INFO uvicorn.error: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-12-13 17:34:09,904 INFO uvicorn.access: 172.22.0.1:38186 - "GET /docs HTTP/1.1" 200
2025-12-13 17:34:10,147 INFO uvicorn.access: 172.22.0.1:38186 - "GET /openapi.json HTTP/1.1" 200
2025-12-13 17:34:24,752 INFO uvicorn.access: 172.22.0.1:38186 - "POST /query HTTP/1.1" 200
2025-12-13 17:38:54,682 INFO uvicorn.error: Shutting down
2025-12-13 17:38:54,783 INFO uvicorn.error: Waiting for application shutdown.
2025-12-13 17:38:54,784 INFO uvicorn.error: Application shutdown complete.
2025-12-13 17:38:54,785 INFO uvicorn.error: Finished server process [1]
2025-12-13 17:39:04,557 INFO uvicorn.error: Started server process [1]
2025-12-13 17:39:04,557 INFO uvicorn.error: Waiting for application startup.
2025-12-13 17:39:04,558 INFO uvicorn.error: Application startup complete.
2025-12-13 17:39:04,559 INFO uvicorn.error: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-12-13 17:39:13,968 INFO uvicorn.access: 172.23.0.1:54534 - "GET /docs HTTP/1.1" 200
2025-12-13 17:39:14,098 INFO uvicorn.access: 172.23.0.1:54534 - "GET /openapi.json HTTP/1.1" 200
2025-12-13 17:40:34,049 INFO uvicorn.error: Started server process [1]
2025-12-13 17:40:34,050 INFO uvicorn.error: Waiting for application startup.
2025-12-13 17:40:34,051 INFO uvicorn.error: Application startup complete.
2025-12-13 17:40:34,053 INFO uvicorn.error: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-12-13 17:40:36,476 INFO uvicorn.access: 172.24.0.1:44400 - "GET /docs HTTP/1.1" 200
2025-12-13 17:40:39,800 INFO uvicorn.access: 172.24.0.1:44400 - "GET /openapi.json HTTP/1.1" 200
2025-12-13 17:40:54,785 INFO uvicorn.access: 172.24.0.1:44400 - "POST /query HTTP/1.1" 200
2025-12-13 17:46:00,502 INFO uvicorn.error: Shutting down
2025-12-13 17:46:00,604 INFO uvicorn.error: Waiting for application shutdown.
2025-12-13 17:46:00,605 INFO uvicorn.error: Application shutdown complete.
2025-12-13 17:46:00,606 INFO uvicorn.error: Finished server process [1]
2025-12-13 17:47:28,694 INFO uvicorn.error: Started server process [1]
2025-12-13 17:47:28,695 INFO uvicorn.error: Waiting for application startup.
2025-12-13 17:47:28,696 INFO uvicorn.error: Application startup complete.
2025-12-13 17:47:28,697 INFO uvicorn.error: Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-12-13 17:47:38,924 INFO uvicorn.access: 172.25.0.1:43054 - "GET /docs HTTP/1.1" 200
2025-12-13 17:47:39,210 INFO uvicorn.access: 172.25.0.1:43054 - "GET /openapi.json HTTP/1.1" 200
2025-12-13 17:47:58,996 INFO uvicorn.access: 172.25.0.1:43062 - "POST /query HTTP/1.1" 200
